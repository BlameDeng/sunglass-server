(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-30a068c6"],{"50a5":function(t,s,e){},"7a07":function(t,s,e){"use strict";var i=function(){var t,s,e=this,i=e.$createElement,n=e._self._c||i;return n("div",{staticClass:"sun-input"},[e.icon?n("x-icon",{staticClass:"icon",class:{focus:e.focus||e.value},attrs:{name:e.icon}}):e._e(),n("input",{class:(t={},t["no-icon"]=!e.icon,t),attrs:{type:e.type},domProps:{value:e.value},on:{focus:e.onFocus,blur:e.onBlur,input:e.onInput,change:e.onChange}}),e.placeholder?n("label",{class:(s={focus:e.focus||e.value},s["no-icon"]=!e.icon,s)},[e._v(e._s(e.placeholder))]):e._e()],1)},n=[],a=e("61e6"),r={name:"sunInput",components:{xIcon:a["a"]},props:{placeholder:String,value:String,icon:String,type:{type:String,default:"text"}},data:function(){return{focus:!1}},methods:{onFocus:function(t){this.focus=!0,this.$emit("focus",t)},onBlur:function(t){this.focus=!1,this.$emit("blur",t)},onInput:function(t){this.$emit("input",t.target.value)},onChange:function(t){this.$emit("change",t)}}},o=r,c=(e("976f"),e("2877")),l=Object(c["a"])(o,i,n,!1,null,"77e11649",null);l.options.__file="input.vue";s["a"]=l.exports},"7f7f":function(t,s,e){var i=e("86cc").f,n=Function.prototype,a=/^\s*function ([^ (]*)/,r="name";r in n||e("9e1e")&&i(n,r,{configurable:!0,get:function(){try{return(""+this).match(a)[1]}catch(t){return""}}})},"973e":function(t,s,e){"use strict";e.r(s);var i=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"payment"},[e("div",{staticClass:"title"},[t._v("\n        确认收货地址\n    ")]),e("div",{staticClass:"address"},[t.receiver?e("div",{staticClass:"detail-address"},[e("p",{staticStyle:{color:"rgba(0,0,0,.45)"}},[t._v("\n                默认收货地址：\n            ")]),e("p",[t._v("\n                "+t._s((t.receiver.address||"")+" "+(t.receiver.name||"")+"（收）")+"\n            ")]),e("p",[t._v("\n                "+t._s((t.receiver.detail||"")+" "+(t.receiver.phone||""))+"\n            ")])]):t._e(),e("div",{staticClass:"btn",attrs:{role:"button"},on:{click:function(s){t.dialogVisible=!0}}},[t._v("\n            使用新地址\n        ")]),e("transition",{attrs:{name:"actions-fade"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.dialogVisible,expression:"dialogVisible"}],staticClass:"mask"},[e("div",{staticClass:"dialog"},[e("div",{staticClass:"address"},[e("div",{staticClass:"info"},[t._v("使用新地址")]),e("div",{staticClass:"wrapper"},[e("p",[e("label",[t._v("收货人：")]),e("sun-input",{staticStyle:{width:"200px"},model:{value:t.name,callback:function(s){t.name=s},expression:"name"}})],1),e("p",[e("label",[t._v("手机号码：")]),e("sun-input",{staticStyle:{width:"200px"},model:{value:t.phone,callback:function(s){t.phone=s},expression:"phone"}})],1)]),e("p",[e("label",[t._v("地址信息：")]),e("sun-input",{staticStyle:{width:"500px"},attrs:{placeholder:"省/市/区"},model:{value:t.address,callback:function(s){t.address=s},expression:"address"}})],1),e("p",[e("label",[t._v("详细地址：")]),e("sun-input",{staticStyle:{width:"500px"},attrs:{placeholder:"详细地址，如：门牌、街道、村镇"},model:{value:t.detail,callback:function(s){t.detail=s},expression:"detail"}})],1)]),e("div",{staticClass:"btn-wrapper"},[e("div",{staticClass:"btn cancle",attrs:{role:"button"},on:{click:t.onCancle}},[t._v("取消")]),e("div",{staticClass:"btn",attrs:{role:"button"},on:{click:t.changeAddress}},[t._v("保存")])])])])])],1),e("div",{staticClass:"title"},[t._v("\n        确认订单信息\n    ")]),t._m(0),e("ul",{staticClass:"goods"},[t.orderProducts&&t.orderProducts.length?[t._l(t.orderProducts,function(s){return e("li",{key:s.id},[e("div",{staticClass:"info"},[e("img",{attrs:{src:s.main_image},on:{click:function(e){t.onProductDetail(s)}}}),e("span",{on:{click:function(e){t.onProductDetail(s)}}},[t._v("\n                        "+t._s(s.title)+"\n                    ")])]),e("div",{staticClass:"price"},[e("span",{staticClass:"text"},[t._v("单价")]),e("span",[t._v("￥"+t._s(s.discount.toFixed(2)))]),s.discount<s.price?e("span",{staticClass:"origin"},[e("span",{staticClass:"text"},[t._v("原价")]),t._v("\n                        ￥"+t._s(s.price.toFixed(2))+"\n                    ")]):t._e()]),e("div",{staticClass:"count"},[e("span",{staticClass:"text"},[t._v("数量")]),t._v("\n                    "+t._s(s.count)+"\n                ")]),e("div",{staticClass:"total"},[e("span",{staticClass:"text"},[t._v("小计")]),t._v("\n                    ￥"+t._s((s.discount*s.count).toFixed(2))+"\n                ")])])}),e("li",{staticClass:"order-info"},[t._m(1),e("div",{staticClass:"all"},[e("span",[t._v("订单合计（含运费）")]),e("span",{staticClass:"number"},[t._v("￥"+t._s(t.total)+".00")])])])]:t._e()],2),e("div",{staticClass:"action-bar"},[t.receiver?e("div",{staticClass:"pay-info"},[e("div",{staticClass:"pay"},[e("span",{staticClass:"label"},[t._v("实付款：")]),e("span",{staticClass:"number"},[t._v("￥"+t._s(t.total)+".00")])]),e("div",{staticClass:"address"},[e("span",{staticClass:"label"},[t._v("寄送至：")]),e("span",{staticClass:"detail"},[t._v("\n                    "+t._s((t.receiver.address||"")+" "+(t.receiver.detail||""))+"\n                ")])]),e("div",{staticClass:"contract"},[e("span",{staticClass:"label"},[t._v("收货人：")]),e("span",[t._v(t._s((t.receiver.name||"")+" "+(t.receiver.phone||"")))])])]):t._e(),e("div",{staticClass:"btns"},[e("div",{staticClass:"return",on:{click:t.onBack}},[e("x-icon",{staticClass:"icon",attrs:{name:"back"}}),e("span",[t._v("\n                    返回购物车\n                ")])],1),e("div",{staticClass:"confirm",class:{disabled:!this.orderProducts||!this.orderProducts.length},on:{click:t.onConfirmToPay}},[t._v("提交并支付")])])]),e("transition",{attrs:{name:"actions-fade"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.checkPasswordVisible,expression:"checkPasswordVisible"}],staticClass:"check-password"},[e("div",{staticClass:"inner"},[e("h3",[t._v("支付订单需要验证登录密码")]),e("sun-input",{staticStyle:{width:"200px"},attrs:{type:"password"},model:{value:t.password,callback:function(s){t.password=s},expression:"password"}}),e("div",{staticClass:"btns"},[e("div",{staticClass:"cancle",on:{click:function(s){t.onCheckAction("cancle")}}},[t._v("取消")]),e("div",{staticClass:"confirm",on:{click:function(s){t.onCheckAction("confirm")}}},[t._v("确定")])])],1)])])],1)},n=[function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ul",{staticClass:"title-bar"},[e("li",{staticClass:"info"},[t._v("商品信息")]),e("li",{staticClass:"price"},[t._v("单价")]),e("li",[t._v("数量")]),e("li",[t._v("小计")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"ems"},[e("span",[t._v("运送方式 EMS 免邮")]),e("span",{staticClass:"number"},[t._v("0.00")])])}],a=(e("7f7f"),e("96cf"),e("1da1")),r=(e("ac6a"),e("61e6")),o=e("7a07"),c=e("fda6"),l={name:"Payment",mixins:[c["a"]],components:{xIcon:r["a"],sunInput:o["a"]},data:function(){return{orderIds:null,dialogVisible:!1,name:"",phone:"",address:"",detail:"",checkPasswordVisible:!1,password:""}},computed:{orderProducts:function(){var t=this;if(this.orderIds&&this.cart&&this.cart.products.length){var s=[];return this.cart.products.forEach(function(e){t.orderIds.indexOf(e.id)>-1&&s.push(e)}),s}return null},total:function(){return this.orderProducts&&this.orderProducts.length?this.orderProducts.reduce(function(t,s){return t+s.count*s.discount},0):0}},watch:{dialogVisible:function(t){t?window.addEventListener("mousewheel",this.listenWindow):window.removeEventListener("mousewheel",this.listenWindow)},checkPasswordVisible:function(t){t?window.addEventListener("mousewheel",this.listenWindow):window.removeEventListener("mousewheel",this.listenWindow)}},mounted:function(){var t=this.$route.query.selectedIds;t instanceof Array?this.orderIds=t.map(function(t){return parseInt(t,10)}):this.orderIds=[parseInt(t,10)],this.getReceiver(),document.title="确认订单"},beforedestroy:function(){window.removeEventListener("mousewheel",this.listenWindow)},methods:{onProductDetail:function(t){window.open("/product.html?id=".concat(t.id),"_blank")},onCancle:function(){this.dialogVisible=!1,this.name="",this.phone="",this.address="",this.detail=""},changeAddress:function(){var t=Object(a["a"])(regeneratorRuntime.mark(function t(){var s=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.name&&this.phone&&this.address&&this.detail){t.next=3;break}return this.$info({message:"联系人、手机号码、地址不能为空！"}),t.abrupt("return");case 3:if(/^[\d]+$/.test(this.phone)){t.next=6;break}return this.$info({message:"手机号码必须为数字！"}),t.abrupt("return");case 6:return t.next=8,this.updateReceiver({name:this.name,phone:this.phone,address:this.address,detail:this.detail}).then(function(t){s.$success({message:"修改收货地址成功"})});case 8:this.dialogVisible=!1;case 9:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),listenWindow:function(t){return t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),!1},onBack:function(){this.$router.go(-1)},onCheckAction:function(t){var s=this;if("cancle"===t)this.checkPasswordVisible=!1,this.password="";else if("confirm"===t){if(!this.password)return void this.$error({message:"必须输入密码"});if(!/.{6,18}/.test(this.password))return void this.$info({message:"密码为6到18个字符"});this.pay({products:this.orderProducts,password:this.password}).then(function(t){s.check().catch(function(t){}),s.$success({message:"支付成功"}),s.checkPasswordVisible=!1,s.password="",s.$router.push("/order")}).catch(function(t){s.$error({message:t.msg}),s.checkPasswordVisible=!1,s.password=""})}},onConfirmToPay:function(){this.receiver.name&&this.receiver.phone&&this.receiver.address&&this.receiver.detail?this.orderProducts&&this.orderProducts.length&&(this.checkPasswordVisible=!0):this.$info({message:"请先完善收货人姓名、手机号码、地址等信息！"})}}},d=l,u=(e("d996"),e("2877")),h=Object(u["a"])(d,i,n,!1,null,"31be0355",null);h.options.__file="payment.vue";s["default"]=h.exports},"976f":function(t,s,e){"use strict";var i=e("50a5"),n=e.n(i);n.a},ac6a:function(t,s,e){for(var i=e("cadf"),n=e("0d58"),a=e("2aba"),r=e("7726"),o=e("32e9"),c=e("84f2"),l=e("2b4c"),d=l("iterator"),u=l("toStringTag"),h=c.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},v=n(p),f=0;f<v.length;f++){var m,_=v[f],C=p[_],w=r[_],b=w&&w.prototype;if(b&&(b[d]||o(b,d,h),b[u]||o(b,u,_),c[_]=h,C))for(m in i)b[m]||a(b,m,i[m],!0)}},c411:function(t,s,e){},d996:function(t,s,e){"use strict";var i=e("c411"),n=e.n(i);n.a}}]);
//# sourceMappingURL=chunk-30a068c6.284fc29b.js.map